# 基于Three.js的三维情感模型可视化

这个模块基于Three.js创建了一个三维情感模型可视化系统，用于展示通过Arduino生物传感器和表情识别技术采集的多模态情感数据。

## 三维情感模型说明

本模型基于采集数据构建模型说明.md中定义的三维情感模型规范，将用户的情感状态映射到一个三维空间中：

- **X轴（效价）：** 从-100到+100，表示情感的正负性
  - 正值：表示积极情绪（如快乐、满足）
  - 负值：表示消极情绪（如悲伤、愤怒）

- **Y轴（唤醒度）：** 从0到100，表示情感的激活程度
  - 高值：表示高度唤醒（如兴奋、愤怒）
  - 低值：表示低度唤醒（如平静、疲倦）

- **Z轴（情感类型）：** 表示离散的情感类别
  - 积极区域：开心、惊讶
  - 中性区域：中性
  - 消极区域：悲伤、恐惧、愤怒、厌恶

## 特性

- **实时可视化：** 根据表情识别和生物传感器数据实时更新情感状态
- **情感球体：** 随着情感变化移动、变色的三维球体表示当前情感状态
- **轨迹线：** 记录情感变化轨迹，形成情感历史路径
- **透明背景：** 支持透明背景，可以与其他UI元素叠加
- **自动旋转相机：** 提供不同角度的情感状态视图
- **情感历史：** 跟踪并显示情感变化的历史轨迹

## 文件说明

- `emotion-model.js` - 三维情感模型的核心JavaScript代码
- `emotion-model.css` - 模型容器和标签的样式文件
- `README.md` - 使用说明文档

## 技术实现

### 数据融合

模型通过监听`emotionFusionUpdate`事件获取融合后的情感数据：

1. **效价 (X轴)：** 表情识别效价值 + HRV归一化值的加权融合
2. **唤醒度 (Y轴)：** 心率BPM和PPG信号斜率的加权融合
3. **情感类型 (Z轴)：** 表情识别分类结果，结合生理信号验证

### 可视化元素

- **情感球体：** 在三维空间中代表当前情感状态的球体
  - 位置对应效价、唤醒度和情感类型
  - 颜色对应情感类型（黄色=开心、蓝色=悲伤等）
  - 不透明度对应情感识别的置信度
  
- **坐标轴和网格：** 帮助用户理解三维空间的参考系

- **轨迹线：** 记录最近的情感变化路径

## 如何使用

1. 在HTML中添加一个容器元素：
   ```html
   <div id="emotion-model-container"></div>
   ```

2. 在JavaScript中初始化模型：
   ```javascript
   const emotionModel = require('./three/emotion-model');
   emotionModel.init('#emotion-model-container');
   ```

3. 确保情感融合模块已发送`emotionFusionUpdate`事件

## 依赖项

- three.js: "^0.175.0" - 3D渲染库

## 自定义配置

可以通过修改`emotion-model.js`文件自定义以下配置：

- 情感颜色映射 (`emotionColors`)
- 情感Z轴位置映射 (`emotionZPos`)
- 轨迹点数量 (`maxTrailPoints`)
- 相机旋转速度和半径 